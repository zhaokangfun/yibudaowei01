function HmoPrint(){}HmoPrint.prototype={doPrint:function(b,a,c){LODOP=getLodop();if(!LODOP){return}this.printHealthProduct(b,a,this.printService);if(b==1){this.printLabExam(c)}else{if(b==2){this.printAssistExam(c)}else{if(b==3){this.printTreatment(c)}}}operateType()},printHealthProduct:function(d,c,f){var a=this;var b={url:ContextClinc_Server+"health_product/health_product_item",dataType:"json",contentType:"application/json;charset=utf-8",data:c,async:false};var e=Utils.myAjaxHandler(b);e.done(function(h){if(h!=null&&h.errorCode==SUCCESSCODE){data=h.data;var j="";var g=Utils.calcPatientAge(Utils.timeStampToDateStr(data.PATIENT_BIRTH_DATE,7));if(g!=""){var k=g.split(",");j+=k[0]+"岁";if(k.length==2&&Utils.notBlank($.trim(k[1]))){j+=k[1]+"月"}}LODOP.PRINT_INITA(1,0,530,763,"");LODOP.SET_PRINT_PAGESIZE(1,1480,2100,"");LODOP.SET_PRINT_MODE("TRYLINKPRINTER_NOALERT",true);LODOP.ADD_PRINT_TEXT(9,6,214,20,"NO."+data.APPT_ORDER_CODE);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(31,215,120,25,"服务申请单");LODOP.SET_PRINT_STYLEA(0,"FontSize",12);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"Alignment",2);LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.ADD_PRINT_LINE(67,1,67,560,0,2);LODOP.ADD_PRINT_TEXT(79,5,50,20,"姓名：");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(79,51,165,20,data.PATIENT_NAME);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(79,238,50,20,"性别：");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(79,282,40,20,parseInt(data.PATIENT_GENDER)==1?"男":(parseInt(data.PATIENT_GENDER)==2?"女":"保密"));LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(79,400,50,20,"年龄：");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(79,443,100,20,j);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(112,5,100,25,"健康商品卡号：");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(112,104,180,25,data.CARD_NO);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_LINE(136,0,136,560,0,2);LODOP.ADD_PRINT_TEXT(150,5,75,20,"服务项目：");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_LINE(314,0,314,560,0,2);LODOP.ADD_PRINT_TEXT(328,5,75,20,"申请时间：");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(328,80,200,20,Utils.timeStampToDateStr(new Date().getTime(),9));LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_LINE(381,0,381,560,2,1);LODOP.ADD_PRINT_TEXT(402,6,214,20,"NO."+data.APPT_ORDER_CODE);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(426,215,120,25,"服务回执单");LODOP.SET_PRINT_STYLEA(0,"FontSize",12);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"Alignment",2);LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.ADD_PRINT_LINE(462,0,462,560,0,2);LODOP.ADD_PRINT_TEXT(474,5,50,20,"姓名：");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(474,51,165,20,data.PATIENT_NAME);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(474,238,50,20,"性别：");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(474,282,40,20,parseInt(data.PATIENT_GENDER)==1?"男":(parseInt(data.PATIENT_GENDER)==2?"女":"保密"));LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(474,400,50,20,"年龄：");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(474,443,100,20,j);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(507,5,100,25,"健康商品卡号：");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(507,104,180,25,data.CARD_NO);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_LINE(533,0,533,560,0,2);LODOP.ADD_PRINT_TEXT(547,5,100,25,"服务情况记录：");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(636,5,100,25,"备注：");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_LINE(725,0,725,560,0,2);LODOP.ADD_PRINT_TEXT(740,5,75,20,"服务日期：");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(740,305,75,20,"医生签名：");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");if(d==0){if(f!=undefined&&typeof(f)=="function"){var i=[];i.push({REAL_HEALTHPRODUCT_NAME:data.REAL_HEALTHPRODUCT_NAME,HEALTH_PRODUCT_NAME:data.HEALTH_PRODUCT_NAME,HEALTH_PRODUCT_ITEM_NAME:data.HEALTH_PRODUCT_ITEM_NAME,HEALTH_PRODUCT_ITEM_REMARK:data.EALTH_PRODUCT_ITEM_REMARK});f(a,i)}}}else{$.paError(h.errorMessage)}}).fail(function(g){$.paError("操作失败!")}).always(function(){})},printService:function(a,b){var c=150;$.each(b,function(d,e){LODOP.ADD_PRINT_TEXT(c,79,365,20,e.HEALTH_PRODUCT_ITEM_NAME);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");c+=24;LODOP.ADD_PRINT_TEXT(c,79,450,20,e.HEALTH_PRODUCT_ITEM_REMARK);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");c+=(a.isExceedLength(e.HEALTH_PRODUCT_ITEM_REMARK,70)?2:1)*20;c+=4})},printTreatment:function(b){var a=this;if(b==null||b.length==0){return}LODOP.ADD_PRINT_SHAPE(4,146,80,480,20,0,1,"#DDDDDD");LODOP.ADD_PRINT_TEXT(150,79,65,20,"项目名称");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(150,326,35,20,"数量");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(150,389,35,20,"备注");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);var c=174;$.each(b,function(d,e){LODOP.ADD_PRINT_TEXT(c,79,225,20,e.ITEMNAME);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(c,326,35,20,e.TREATNUM);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(c,389,155,20,e.TPREMARK);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);c+=(a.isExceedLength(e.ITEMNAME,30)||a.isExceedLength(e.TPREMARK,22)?2:1)*24})},printLabExam:function(b){var a=this;if(b==null||b.length==0){return}LODOP.ADD_PRINT_SHAPE(4,146,80,480,20,0,1,"#DDDDDD");LODOP.ADD_PRINT_TEXT(150,79,65,20,"项目名称");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(150,326,35,20,"标本");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);var c=174;$.each(b,function(d,e){LODOP.ADD_PRINT_TEXT(c,79,225,20,e.ITEMNAME);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(c,326,150,20,e.SAMPLES);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);c+=(a.isExceedLength(e.ITEMNAME,30)?2:1)*24})},printAssistExam:function(b){var a=this;if(b==null||b.length==0){return}LODOP.ADD_PRINT_SHAPE(4,146,80,480,20,0,1,"#DDDDDD");LODOP.ADD_PRINT_TEXT(150,79,65,20,"项目名称");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(150,290,35,20,"部位");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(150,389,35,20,"病情");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);var c=174;$.each(b,function(d,e){LODOP.ADD_PRINT_TEXT(c,79,200,20,e.ITEMNAME);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.ADD_PRINT_TEXT(c,290,90,20,e.PARTS);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(c,389,155,20,e.ILLSTAT);LODOP.SET_PRINT_STYLEA(0,"FontSize",10);c+=(a.isExceedLength(e.ITEMNAME,30)||a.isExceedLength(e.ILLSTAT,22)?2:1)*24})},isExceedLength:function(d,c){if(d&&d.length>0){var b=0;for(var a=0;a<d.length;a++){var e=d.charAt(a);b++;if(escape(e).length>4){b++}}return b>c}return false}};