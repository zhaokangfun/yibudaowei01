var charge_model=Class.create({checkOutPrintBody:function(e){LODOP=getLodop();if(!LODOP){return}LODOP.PRINT_INITA(0,0,530,763,"");LODOP.SET_PRINT_PAGESIZE(1,2100,1480,"");LODOP.SET_PRINT_MODE("TRYLINKPRINTER_NOALERT",true);charge_model.checkOutPrintHead(e);var c=167;var g=0;for(var b=0;b<e.reportItem.length;b++){if(c>417){charge_model.checkOutPrintFoot(e);LODOP.NEWPAGEA();charge_model.checkOutPrintHead(e);c=167;g=0}LODOP.ADD_PRINT_TEXT(167+25*g,20,40,25,b+1);LODOP.ADD_PRINT_TEXT(167+25*g,60,160,25,e.reportItem[b].projectName);LODOP.ADD_PRINT_TEXT(167+25*g,220,145,25,e.reportItem[b].projectResult);LODOP.ADD_PRINT_TEXT(167+25*g,365,80,10,e.reportItem[b].projectResultPrompt==null?"":e.reportItem[b].projectResultPrompt);LODOP.SET_PRINT_STYLEA(0,"FontColor","#FF0000");LODOP.ADD_PRINT_TEXT(167+25*g,445,105,25,e.reportItem[b].projectUnit);var f=e.reportItem[b].referenceRangeFrom==null?"":e.reportItem[b].referenceRangeFrom;var a=e.reportItem[b].referenceRangeTo==null?"":e.reportItem[b].referenceRangeTo;var d=(a=="")?f:(f+"-"+a);LODOP.ADD_PRINT_TEXT(167+25*g,550,160,25,d);c+=25;g++}charge_model.checkOutPrintFoot(e);operateType()},checkOutPrintHead:function(b){var a=b.clinicName;var f=b.patientKeyInfor.patientName;var e=b.patientKeyInfor.genderTxt;var h=b.patientKeyInfor.age;var i=b.patientNo;var d=b.examSampleName;var g=b.acography.departmentName==null?"":b.acography.departmentName;var c="无";if(b.diagnosisRecord!=null){if(b.diagnosisRecord.diagnosisIcd10!=null){c=b.diagnosisRecord.diagnosisIcd10}else{if(b.diagnosisRecord.diagnosis!=null){c=b.diagnosisRecord.diagnosis}}}LODOP.ADD_PRINT_TEXT(20,181,400,36,a+"检验报告单");LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",16);LODOP.SET_PRINT_STYLEA(0,"Alignment",2);LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.ADD_PRINT_LINE(76,20,76,"187mm",0,2);LODOP.ADD_PRINT_TEXT(82,20,70,25,"姓    名:");LODOP.ADD_PRINT_TEXT(82,90,100,25,f);LODOP.ADD_PRINT_TEXT(82,190,70,25,"性    别:");LODOP.ADD_PRINT_TEXT(82,260,100,25,e);LODOP.ADD_PRINT_TEXT(82,360,70,25,"年    龄:");LODOP.ADD_PRINT_TEXT(82,430,100,25,h);LODOP.ADD_PRINT_TEXT(82,530,70,25,"病历号：");LODOP.ADD_PRINT_TEXT(82,600,100,25,i);LODOP.ADD_PRINT_TEXT(107,20,70,25,"基本类型:");LODOP.ADD_PRINT_TEXT(107,90,100,25,d);LODOP.ADD_PRINT_TEXT(107,190,70,25,"科    室:");LODOP.ADD_PRINT_TEXT(107,260,100,25,g);LODOP.ADD_PRINT_TEXT(107,360,70,25,"临床诊断:");LODOP.ADD_PRINT_TEXT(107,430,100,25,c);LODOP.ADD_PRINT_LINE(132,20,132,"187mm",0,2);LODOP.ADD_PRINT_TEXT(137,20,40,25,"序");LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.SET_PRINT_STYLEA(0,"ItemType",1);LODOP.ADD_PRINT_TEXT(137,60,160,25,"项目名称");LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.SET_PRINT_STYLEA(0,"ItemType",1);LODOP.ADD_PRINT_TEXT(137,220,145,25,"结果");LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.SET_PRINT_STYLEA(0,"ItemType",1);LODOP.ADD_PRINT_TEXT(137,365,80,25,"");LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.SET_PRINT_STYLEA(0,"ItemType",1);LODOP.ADD_PRINT_TEXT(137,445,105,25,"单位");LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.SET_PRINT_STYLEA(0,"ItemType",1);LODOP.ADD_PRINT_TEXT(137,550,160,25,"参考范围");LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.SET_PRINT_STYLEA(0,"ItemType",1)},checkOutPrintFoot:function(d){var c=d.examer==null?"":d.examer;var e=d.reportDateTxt==null?"":d.reportDateTxt;var b=d.acography.doctorName==null?"":d.acography.doctorName;var a=d.examDateTxt==null?"":d.examDateTxt;LODOP.ADD_PRINT_LINE(438,0,438,"193mm",0,2);LODOP.ADD_PRINT_TEXT(447,20,70,25,"申请医生：");LODOP.ADD_PRINT_TEXT(447,90,70,25,b);LODOP.ADD_PRINT_TEXT(447,160,70,25,"申请时间:");LODOP.ADD_PRINT_TEXT(447,230,135,25,a);LODOP.ADD_PRINT_TEXT(447,385,65,25,"检验者：");LODOP.ADD_PRINT_TEXT(447,450,85,25,c);LODOP.ADD_PRINT_TEXT(447,535,65,25,"报告时间:");LODOP.ADD_PRINT_TEXT(447,600,135,25,e);LODOP.ADD_PRINT_TEXT(497,200,360,25,"本检测结果只对本次标本负责，如有疑问，请及时提出。");LODOP.SET_PRINT_STYLEA(0,"Alignment",2)},inspectPrint:function(j){var g=j.clinicName;var n=j.patientKeyInfor.patientName;var m=j.patientKeyInfor.genderTxt;var p=j.patientKeyInfor.age;var o=j.acography.departmentName==null?"":j.acography.departmentName;var q=j.patientNo;var l=j.examDate==null?"":j.examDate;var f=j.examPosition==null?"":j.examPosition;var k="无";if(j.diagnosisRecord!=null){if(j.diagnosisRecord.diagnosisIcd10!=null){k=j.diagnosisRecord.diagnosisIcd10}else{if(j.diagnosisRecord.diagnosis!=null){k=j.diagnosisRecord.diagnosis}}}var b=j.examDescription==null?"":j.examDescription;var e=j.examConclusion==null?"":j.examConclusion;var d=j.examDoctor==null?"":j.examDoctor;var l=j.examDateTxt==null?"":j.examDateTxt;var c=j.auditDoctor==null?"":j.auditDoctor;LODOP=getLodop();if(!LODOP){return}LODOP.PRINT_INITA(0,0,794,1123,"");LODOP.SET_PRINT_PAGESIZE(1,0,0,"A4");LODOP.SET_PRINT_MODE("TRYLINKPRINTER_NOALERT",true);LODOP.ADD_PRINT_TEXT(24,197,400,36,g+"检查报告单");LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");LODOP.SET_PRINT_STYLEA(0,"FontSize",14);LODOP.SET_PRINT_STYLEA(0,"Alignment",2);LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.ADD_PRINT_LINE(58,20,60,770,0,2);LODOP.ADD_PRINT_TEXT(62,40,60,25,"姓名：");LODOP.ADD_PRINT_TEXT(62,100,120,25,n);LODOP.ADD_PRINT_TEXT(62,300,60,25,"性别：");LODOP.ADD_PRINT_TEXT(62,360,120,25,m);LODOP.ADD_PRINT_TEXT(62,550,60,25,"年龄：");LODOP.ADD_PRINT_TEXT(62,610,120,25,p);LODOP.ADD_PRINT_TEXT(87,40,60,25,"科别：");LODOP.ADD_PRINT_TEXT(87,100,120,25,o);LODOP.ADD_PRINT_TEXT(87,300,60,25,"病历号：");LODOP.ADD_PRINT_TEXT(87,360,120,25,q);LODOP.ADD_PRINT_TEXT(87,550,80,25,"检查时间：");LODOP.ADD_PRINT_TEXT(87,610,180,25,l);LODOP.ADD_PRINT_TEXT(112,40,80,25,"检查项目：");LODOP.ADD_PRINT_TEXT(112,120,120,25,k);LODOP.ADD_PRINT_TEXT(112,300,80,25,"临床诊断：");LODOP.ADD_PRINT_TEXT(112,360,120,25,f);LODOP.ADD_PRINT_LINE(137,20,140,770,0,2);LODOP.ADD_PRINT_TEXT(142,40,100,25,"心电图特征：");LODOP.ADD_PRINT_TEXT(142,145,500,25,b);for(var h=0;h<j.reportItem.length;h++){var a="<img src='"+j.reportItem[h].imageUrl+"' width='710' />";LODOP.ADD_PRINT_IMAGE(175+(h*349),40,710,349,a)}LODOP.ADD_PRINT_TEXT(900,40,100,25,"心电图诊断：");LODOP.ADD_PRINT_TEXT(900,140,500,100,e);LODOP.ADD_PRINT_LINE(1009,20,1008,770,0,2);LODOP.ADD_PRINT_TEXT(1015,40,80,25,"报告医师：");LODOP.ADD_PRINT_TEXT(1015,120,100,25,d);LODOP.ADD_PRINT_TEXT(1015,280,80,25,"审核医师：");LODOP.ADD_PRINT_TEXT(1015,360,100,25,c);LODOP.ADD_PRINT_TEXT(1015,510,80,25,"报告时间：");LODOP.ADD_PRINT_TEXT(1015,590,150,25,l);LODOP.ADD_PRINT_TEXT(1075,227,300,25,"此报告仅供临床参考,不做它用!");LODOP.SET_PRINT_STYLEA(0,"Alignment",2);operateType()},registrationPrint:function(r){var e="HFC010";var q="张青连锁诊所";var o="HFC201707201456223";var h="医疗报销";var c="王昭君";var j="201556426";var a="内科";var g="20";var n="20.0";var f="1.00";var l="19.00";var m="18.00";var p="18.00";var i="2.00";var b="20.00";var d="2017-07-20";var k="小张";LODOP=getLodop();if(!LODOP){return}LODOP.PRINT_INITA(0,0,794,1123,"");LODOP.SET_PRINT_PAGESIZE(1,0,0,"A4");LODOP.SET_PRINT_MODE("TRYLINKPRINTER_NOALERT",true);LODOP.ADD_PRINT_TEXT(20,150,400,30,"门诊挂号单");LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",12);LODOP.SET_PRINT_STYLEA(0,"Alignment",2);LODOP.ADD_PRINT_TEXT(52,20,70,25,"医院编码:");LODOP.ADD_PRINT_TEXT(52,90,200,25,e);LODOP.ADD_PRINT_TEXT(52,340,70,25,"医院名称：");LODOP.ADD_PRINT_TEXT(52,410,200,25,q);LODOP.ADD_PRINT_TEXT(77,20,80,25,"门诊流水号:");LODOP.ADD_PRINT_TEXT(77,100,200,25,o);LODOP.ADD_PRINT_TEXT(77,340,70,25,"病人类型：");LODOP.ADD_PRINT_TEXT(77,410,200,25,h);LODOP.ADD_PRINT_TEXT(102,20,40,25,"姓名:");LODOP.ADD_PRINT_TEXT(102,60,200,25,c);LODOP.ADD_PRINT_TEXT(102,340,60,25,"电脑号：");LODOP.ADD_PRINT_TEXT(102,400,200,25,j);LODOP.ADD_PRINT_TEXT(127,20,70,25,"挂号科室:");LODOP.ADD_PRINT_TEXT(127,90,200,25,a);LODOP.ADD_PRINT_TEXT(127,340,60,25,"挂号费：");LODOP.ADD_PRINT_TEXT(127,400,200,25,g);LODOP.ADD_PRINT_TEXT(152,20,40,25,"诊金:");LODOP.ADD_PRINT_TEXT(152,60,200,25,n);LODOP.ADD_PRINT_TEXT(152,340,95,25,"个人账户余额：");LODOP.ADD_PRINT_TEXT(152,435,200,25,f);LODOP.ADD_PRINT_TEXT(177,20,70,25,"合计金额:");LODOP.ADD_PRINT_TEXT(177,90,200,25,l);LODOP.ADD_PRINT_TEXT(202,20,70,25,"现金合计:");LODOP.ADD_PRINT_TEXT(202,90,200,25,m);LODOP.ADD_PRINT_TEXT(227,20,70,25,"记账合计:");LODOP.ADD_PRINT_TEXT(227,90,200,25,p);LODOP.ADD_PRINT_TEXT(227,340,60,25,"找赎金：");LODOP.ADD_PRINT_TEXT(227,400,200,25,i);LODOP.ADD_PRINT_TEXT(252,20,60,25,"实收金:");LODOP.ADD_PRINT_TEXT(252,80,200,25,b);LODOP.ADD_PRINT_TEXT(292,20,40,25,"日期:");LODOP.ADD_PRINT_TEXT(292,60,200,25,d);LODOP.ADD_PRINT_TEXT(292,450,60,25,"操作员：");LODOP.ADD_PRINT_TEXT(292,510,100,25,k);operateType()},xiKangCheckOutPrintBody:function(e){LODOP=getLodop();if(!LODOP){return}LODOP.PRINT_INITA(0,0,530,763,"");LODOP.SET_PRINT_PAGESIZE(1,2100,1480,"");LODOP.SET_PRINT_MODE("TRYLINKPRINTER_NOALERT",true);charge_model.xiKangCheckOutPrintHead(e);var c=167;var g=0;for(var b=0;b<e.reportResult.length;b++){if(c>417){charge_model.checkOutPrintFoot(e);LODOP.NEWPAGEA();charge_model.xiKangCheckOutPrintHead(e);c=167;g=0}LODOP.ADD_PRINT_TEXT(167+25*g,20,40,25,b+1);LODOP.ADD_PRINT_TEXT(167+25*g,60,160,25,e.reportResult[b].projectName);LODOP.ADD_PRINT_TEXT(167+25*g,220,145,25,e.reportResult[b].projectResult);LODOP.ADD_PRINT_TEXT(167+25*g,365,80,10,e.reportResult[b].projectResultPrompt==null?"":e.reportResult[b].projectResultPrompt);LODOP.SET_PRINT_STYLEA(0,"FontColor","#FF0000");LODOP.ADD_PRINT_TEXT(167+25*g,445,105,25,e.reportResult[b].projectUnit);var f=e.reportResult[b].referenceRangeFrom==null?"":e.reportResult[b].referenceRangeFrom;var a=e.reportResult[b].referenceRangeTo==null?"":e.reportResult[b].referenceRangeTo;var d=(a=="")?f:(f+"-"+a);LODOP.ADD_PRINT_TEXT(167+25*g,550,160,25,d);c+=25;g++}charge_model.xiKangcheckOutPrintFoot(e);operateType()},xiKangCheckOutPrintHead:function(b){var a=b.clinicName;var f=b.patientKeyInfor.patientName;var e=b.patientKeyInfor.genderTxt;var h=b.patientKeyInfor.age;var i=b.patientNo;var d=b.examName;var g=b.acography.departmentName==null?"":b.acography.departmentName;var c="无";if(b.diagnosisRecord!=null){if(b.diagnosisRecord.diagnosisIcd10!=null){c=b.diagnosisRecord.diagnosisIcd10}else{if(b.diagnosisRecord.diagnosis!=null){c=b.diagnosisRecord.diagnosis}}}LODOP.ADD_PRINT_TEXT(20,181,400,36,a+"检验报告单");LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",16);LODOP.SET_PRINT_STYLEA(0,"Alignment",2);LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.ADD_PRINT_LINE(76,20,76,"187mm",0,2);LODOP.ADD_PRINT_TEXT(82,20,70,25,"姓    名:");LODOP.ADD_PRINT_TEXT(82,90,100,25,f);LODOP.ADD_PRINT_TEXT(82,190,70,25,"性    别:");LODOP.ADD_PRINT_TEXT(82,260,100,25,e);LODOP.ADD_PRINT_TEXT(82,360,70,25,"年    龄:");LODOP.ADD_PRINT_TEXT(82,430,100,25,h);LODOP.ADD_PRINT_TEXT(82,530,70,25,"病历号：");LODOP.ADD_PRINT_TEXT(82,600,100,25,i);LODOP.ADD_PRINT_TEXT(107,20,70,25,"检查项目:");LODOP.ADD_PRINT_TEXT(107,90,100,25,d);LODOP.ADD_PRINT_TEXT(107,190,70,25,"科    室:");LODOP.ADD_PRINT_TEXT(107,260,100,25,g);LODOP.ADD_PRINT_TEXT(107,360,70,25,"临床诊断:");LODOP.ADD_PRINT_TEXT(107,430,100,25,c);LODOP.ADD_PRINT_LINE(132,20,132,"187mm",0,2);LODOP.ADD_PRINT_TEXT(137,20,40,25,"序");LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.SET_PRINT_STYLEA(0,"ItemType",1);LODOP.ADD_PRINT_TEXT(137,60,160,25,"项目名称");LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.SET_PRINT_STYLEA(0,"ItemType",1);LODOP.ADD_PRINT_TEXT(137,220,145,25,"结果");LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.SET_PRINT_STYLEA(0,"ItemType",1);LODOP.ADD_PRINT_TEXT(137,365,80,25,"");LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.SET_PRINT_STYLEA(0,"ItemType",1);LODOP.ADD_PRINT_TEXT(137,445,105,25,"单位");LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.SET_PRINT_STYLEA(0,"ItemType",1);LODOP.ADD_PRINT_TEXT(137,550,160,25,"参考范围");LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.SET_PRINT_STYLEA(0,"ItemType",1)},xiKangcheckOutPrintFoot:function(c){var d=c.examDoctor==null?"":c.examDoctor;var b=c.examDateTxt==null?"":c.examDateTxt;var a=c.auditDoctor==null?"":c.auditDoctor;LODOP.ADD_PRINT_TEXT(447,20,70,25,"报告医师：");LODOP.ADD_PRINT_TEXT(447,90,70,25,d);LODOP.ADD_PRINT_TEXT(447,160,70,25,"审核医师：");LODOP.ADD_PRINT_TEXT(447,230,135,25,a);LODOP.ADD_PRINT_TEXT(447,535,70,25,"报告时间：");LODOP.ADD_PRINT_TEXT(447,600,135,25,b);LODOP.ADD_PRINT_TEXT(465,227,300,25,"此报告仅供临床参考,不做它用!");LODOP.SET_PRINT_STYLEA(0,"Alignment",2)},});