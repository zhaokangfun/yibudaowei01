$(function(){if(window.attachEvent){window.attachEvent("onload",a)}else{window.addEventListener("load",a,false)}function a(){var c=document.createElement("script");c.src="https://localhost:8443/CLodopfuncs.js?priority=2";var b=document.head||document.getElementsByTagName("head")[0]||document.documentElement;b.insertBefore(c,b.firstChild);c=document.createElement("script");c.src="https://localhost:8444/CLodopfuncs.js?priority=2";var b=document.head||document.getElementsByTagName("head")[0]||document.documentElement;b.insertBefore(c,b.firstChild);c=document.createElement("script");c.src="https://localhost:8445/CLodopfuncs.js?priority=2";var b=document.head||document.getElementsByTagName("head")[0]||document.documentElement;b.insertBefore(c,b.firstChild)}});var LODOP;var printerListFlag=true;var reviewFlag;var printType;var installFlag=true;function getLodop(f,b){var h="您需要下载并安装控件才能打印，确认下载？";var a="您需要更新控件才能打印，确认下载？";var g="https://fs02.pinganwj.com/group1/M00/00/20/rBAyQVk3sx-IBKO0ADmBY7pixRgAAAMggIT-uwAOYF7107.exe?filename=pingan_print_tool_setup.exe";try{var d=(navigator.userAgent.indexOf("MSIE")>=0)||(navigator.userAgent.indexOf("Trident")>=0);try{LODOP=getCLodop()}catch(e){}if(!LODOP){if(isFirefox=navigator.userAgent.indexOf("Firefox")>0){window.open("https://localhost:8443");installFlag=false}var c={msg:h,cancelTxt:"取消",saveTxt:"确定",onYes:function(){window.open(g);if(f){f()}}};$.paConfirm(c);installFlag=false;return}else{if(CLODOP.CVERSION<"2.0.4.6"){var c={msg:a,cancelTxt:"取消",saveTxt:"确定",onYes:function(){window.open(g)}};$.paConfirm(c);installFlag=false;return}if(!LODOP&&document.readyState!=="complete"){showMsg("打印插件没准备好，请稍后再试！");return}}LODOP.SET_LICENSES("平安万家医疗投资管理有限责任公司","CECA74D189F5DFD01B5FFB7A07AC680C","平安萬家醫療投資管理有限責任公司","786DCF8C4DB455D1DEED205DD60E998C");LODOP.SET_LICENSES("THIRD LICENSE","","Pingan Wanjia Healthcare Investment Management Co.,Ltd","852106C9FAE6F491D646A52D6A63DE45");return LODOP}catch(e){}}function getPrinterList(){var e=new Array();var c=getPrinterCount();for(var b=0;b<c;b++){var f={};f.key=getPrinterName(b);f.value=getPrinterName(b).substring(0,25);e.push(f)}return e}function getPrinterCount(){LODOP=getLodop();if(!LODOP){return}return LODOP.GET_PRINTER_COUNT()}function getPrinterName(a){return LODOP.GET_PRINTER_NAME(a)}function operateType(a){if(reviewFlag==true){reviewFlag=false;$.paSuccess("生成预览...");LODOP.PREVIEW();if(a){a()}return}$.paSuccess("正在打印...");LODOP.SET_PRINT_MODE("TRYLINKPRINTER_NOALERT",true);LODOP.PRINT();if(a){a()}};