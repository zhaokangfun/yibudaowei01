var speech_synthesis_access_token="";function SpeechSynthesis(){this.flagCount=0;this.retryCount=3;this.spd=5;this.pit=5;this.vol=9;this.per=0;this.cuid="pawj";this.baiduText2audioUrl="https://tsn.baidu.com/text2audio?lan=zh&ctp=1&cuid="+this.cuid+"&vol="+this.vol+"&per="+this.per+"&spd="+this.spd+"&pit="+this.pit}SpeechSynthesis.prototype={playSound:function(f){var b=this;if(!speech_synthesis_access_token){b.getToken()}var a=encodeURI(f);var c=b.baiduText2audioUrl+"&tex="+a+"&tok="+speech_synthesis_access_token;var d=document.getElementById("speech_synthesis");if(d){var e=d.children[0];e.setAttribute("src",c);d.load()}else{d=document.createElement("audio");d.setAttribute("id","speech_synthesis");var e=document.createElement("source");e.setAttribute("type","audio/mpeg");e.setAttribute("src",c);d.appendChild(e);d.addEventListener("ended",function(){d.classList.remove("playing")});document.body.insertBefore(d,document.body.firstChild)}d.addEventListener("error",function(g){if(b.flagCount<b.retryCount){b.flagCount++;b.getToken();b.playSound(a)}},true);if(b.flagCount==b.retryCount){$.paWarn("语音出现故障，请检查网络或稍后重试!")}d.classList.add("playing");d.play()},isPlaying:function(){var a=document.getElementById("speech_synthesis");return !!(a&&a.getAttribute("class")==="playing")},getToken:function(){var b=this;b.isDev();var d={};var a=b.isDev()?"getTokenDev":"getToken";var c={url:ContextClinc_Server+"SpeechSynthesis/"+a,dataType:"json",async:false,data:d};var e=Utils.myAjaxHandler(c);e.done(function(f){if(f.errorCode==SUCCESSCODE){speech_synthesis_access_token=f.data.access_token}})},isDev:function(){var a=window.location.href;if(a.indexOf("127.0.0.1")!=-1||a.indexOf("localhost")!=-1){return true}else{return false}}};