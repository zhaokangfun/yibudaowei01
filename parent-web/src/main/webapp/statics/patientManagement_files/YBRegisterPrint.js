function YBRegisterPrint(){}YBRegisterPrint.prototype={doPrint:function(d,c){var a=this;LODOP=getLodop();if(!LODOP){return}LODOP.PRINT_INITA(0,0,763,530,"");LODOP.SET_PRINT_PAGESIZE(1,2100,1480,"");if(c=="1"){LODOP.ADD_PRINT_TEXT(30,10,735,25,"门诊挂号单")}else{if(c=="2"){LODOP.ADD_PRINT_TEXT(30,10,735,25,"门诊退号单")}}LODOP.SET_PRINT_STYLEA(0,"FontSize",15);LODOP.SET_PRINT_STYLEA(0,"Alignment",2);LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.ADD_PRINT_TEXT(80,10,367,25,"医院编码："+d.ORG_CODE);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(80,377,367,25,"医院名称："+d.CLINIC_NAME);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(110,10,367,25,"门诊流水号："+(d.PATIENT_NO||""));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(110,377,367,25,"医疗类别："+(d.YB_ACOGRAPHY_TYPE_NAME||""));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(140,10,367,25,"姓名："+d.PATIENT_NAME);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(140,377,367,25,"医疗证号："+(d.YB_INSURANCE_NO||""));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(170,10,367,25,"挂号科室："+d.DEPARTMENT_NAME);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(170,377,367,25,"个人账户余额："+(a.toDecimal2(d.YB_BALANCE)||""));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);var e=200;if(d.treatmentList!=null&&d.treatmentList.length!=null&&d.treatmentList.length>0){for(var b=0;b<d.treatmentList.length;b++){LODOP.ADD_PRINT_TEXT(e,10+367*(b%2),367,25,(d.treatmentList[b].TREATMENT_NAME||"")+"："+(c=="2"?"-":"")+(a.toDecimal2(d.treatmentList[b].TREATMENT_PRICE)));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);if(b%2==1){e+=30;if(b%2==0){e-=30}}}}else{e-=30}e+=30;LODOP.ADD_PRINT_TEXT(e,10,367,25,"合计总额："+(((c=="2"?"-":"")+a.toDecimal2(d.TOTAL_PRICE_FEE))||""));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(e,377,367,25,"记账合计："+(((c=="2"?"-":"")+a.toDecimal2(d.PERSON_PAY_AMOUNT))||""));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(e+30,10,367,25,"基金支付："+(((c=="2"?"-":"")+a.toDecimal2(d.FUND_PAY_AMOUNT))||""));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(e+30,377,367,25,"现金合计："+(((c=="2"?"-":"")+a.toDecimal2(d.actualPayMoney))||""));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(e+60,10,367,25,"实收金："+(((c=="2"?"-":"")+a.toDecimal2(d.actualPayMoney))||""));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(e+90,10,367,25,"日期："+d.dataTime);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.ADD_PRINT_TEXT(e+90,377,367,25,"收费员："+(d.ybOptUser||""));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);operateType()},toDecimal2:function(a){var d=parseFloat(a);if(isNaN(d)||d<0){return"0.00"}var d=Math.round(a*100)/100;var c=d.toString();var b=c.indexOf(".");if(b<0){b=c.length;c+="."}while(c.length<=b+2){c+="0"}return c}};var YBRegisterPrint=new YBRegisterPrint();