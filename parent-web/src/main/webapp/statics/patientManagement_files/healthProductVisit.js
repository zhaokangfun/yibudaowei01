var HealthProductVisitUtil={initButtonAttr:function(c,a,g){var b=Utils.trimObj(g.HEALTH_PRODUCT_ITEM_ID);var i=Utils.trimObj(g.HEALTH_PRODUCT_ID);var h=Utils.trimObj(g.APPT_FLAG);var f=Utils.trimObj(g.IS_SUPPORT_EQUIVALENCE);var d=Utils.trimObj(g.DEPOSIT_FLAG);var e=Utils.trimObj(g.APPT_PRODUCT_TYPE);a.attr("recordId",c);a.attr("apptProductType",e);a.attr("appt_flag",h);a.attr("isSupportEquivalence",f);a.attr("health_product_item_id",b);a.attr("health_product_id",i);a.attr("depositFlag",d);a.attr("validEndDate",Utils.trimObj(g.VALID_END_DATE));a.attr("currentDate",Utils.trimObj(g.CURRENT_DATE));a.attr("clinicProductFlag",Utils.trimObj(g.CLINIC_PRODUCT_FLAG))},initBindEvent:function(i,f){var e=i.attr("recordId");var g=i.attr("apptProductType");var j=i.attr("appt_flag");j=j?j:1;var h=i.attr("isSupportEquivalence");var c=i.attr("health_product_item_id");var l=i.attr("health_product_id");var d=i.attr("depositFlag")+"";if(j=="1"){var k=i.attr("validEndDate")+"";var b=i.attr("currentDate")+"";var a=i.attr("clinicProductFlag")+"";if(a=="1"&&k&&b>k){$.paWarn("该健康产品已超过使用有效期，请提醒客户操作退款。");return}$("#confirmButton").attr("recordId",e);$("#confirmButton").attr("apptProductType",g);$("#treatmentNum").val("");if(h==1){this.checkEquivalenceItem(l,c,e)}else{$(".healthProductItemClass").hide();$("#insertTreatmentNumtitle").text("就诊码输入");$("#insertTreatmentNum").show();$("#treatmentNum").focus()}if(d=="1"){$(".baimudiClass").remove();this.initBaimudiDom("seeCodeTitleDiv");$("#baimudi").attr("depositFlag",d)}else{$(".baimudiClass").remove();$("#baimudi").attr("depositFlag",d)}}else{if(f&&f.apptIsReceive_yes){f.apptIsReceive_yes(e,"0","",g)}else{apptIsReceive_yes(e,"0","",g)}}},checkEquivalenceItem:function(d,c,b){var f={HEALTH_PRODUCT_ITEM_ID:c,HEALTH_PRODUCT_ID:d,RECORD_ID:b};var a={type:"POST",contentType:"application/json; charset=utf-8",url:ContextClinc_Server+"clinicAppt/checkEquivalenceItem",data:JSON.stringify(f),dataType:"json",showMask:true};var e=Utils.myAjaxHandler(a);e.done(function(j){if(!j.errorMessage){if(!j.data.result){$("#insertTreatmentNumtitle").text("选择健康商品服务项目");$("#healthProductItems").find(".radio-item").remove();if(j.data.items&&j.data.items.length>0){for(var g=0;g<j.data.items.length;g++){var h=$("#line_clone").clone(true);h.find(".healthProductItemRemark").text(j.data.items[g].instruct);h.find(".healthProductItemName").text(j.data.items[g].serviceName+"（"+j.data.items[g].serviceCount+"）次");if(j.data.items[g].serviceId==c){h.find("span").addClass("active")}h.data("serviceItem",j.data.items[g]);h.appendTo($("#healthProductItems"));h.show()}$("#healthProductItems").show()}$(".healthProductItemClass").show();$("#insertTreatmentNum").show();$("#treatmentNum").focus()}else{$(".healthProductItemClass").hide();$("#insertTreatmentNumtitle").text("就诊码输入");$("#insertTreatmentNum").show();$("#treatmentNum").focus()}}else{$.paWarn(j.errorMessage)}}).fail(function(g){$.paError("请求异常")}).always(function(){})},initBaimudiDom:function(a){$(".baimudiClass").remove();var b='<div class="baimudiClass pt-title" style="text-align: left">';b+="   <h2>百慕迪健康商品押金支付方式</h2>";b+="</div>";b+='<div class="baimudiClass">';b+='     <ul id="baimudi" style="margin-left:20px;margin-top:2px;"><li class="radio-item clear">';b+='		<span depositType="1"><i class="service-note">POS</i></span>';b+='		<span depositType="2"><i class="service-note">现金</i></span>';b+='		<span depositType="3"><i class="service-note">微信</i></span>';b+='		<span depositType="4"><i class="service-note">支付宝</i></span>';b+="		</li>";b+="	  </ul>";b+="	  <br>";b+='	  <div style="margin-top:6px;margin-left:20px;position:static;text-align:left;">';b+='		      押金金额:&nbsp;&nbsp;<input id="depositAmt" placeholder="请输入押金金额" type="text" class="input-text-service" maxlength="9">';b+="	  </div>";b+="</div>";$("#"+a).before(b)}};$("body").on("click","#healthProductItems li",function(){var a=$(this).find("span");if(!a.hasClass("active")){a.addClass("active");$(this).siblings("li").find("span").removeClass("active")}});$("body").on("click","#baimudi span",function(){var a=$(this);if(!a.hasClass("active")){a.addClass("active");$(this).siblings("span").removeClass("active")}});