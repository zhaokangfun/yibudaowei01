var return_msg={};function scanGetPatientInfoByRecordId(c,b){if(c){var e={RECORD_ID:c};var a={type:"POST",contentType:"application/json; charset=utf-8",url:ContextClinc_Server+"clinicAppt/getPatientInfoByRecordId",data:JSON.stringify(e),dataType:"json",async:true,showMask:true};var d=Utils.myAjaxHandler(a);d.done(function(f){if(f.errorCode==SUCCESSCODE){return_msg=f;renderPatientInfoWindow(f.data,b)}else{$.paWarn(f.errorMessage)}}).fail(function(f){$.paError("请求异常")}).always(function(){})}}function renderPatientInfoWindow(e,k){$showRecordDetail=$("#showRecordDetail");$showRecordDetail.show();var j=e.APPT_STATUS;var h=e.IS_CLINIC_TREATMENT_CONFIRM;var l=e.IS_CONFIRM;var i=e.APPT_FLAG;var b=$(window).height();if(b<740&&i==1){$showRecordDetail.addClass("h-400").removeClass("h-421")}else{if(b<740&&i==0){$showRecordDetail.addClass("h-421").removeClass("h-400")}else{if(b>=740){$showRecordDetail.removeClass("h-400").removeClass("h-421")}}}if(j==0){$showRecordDetail.find(".bot-info").hide();$showRecordDetail.find(".status-text").text("预约已取消").addClass("appt_false").removeClass("appt_warn").removeClass("appt_right")}else{if(j==1){if(l==1&&h==0){$showRecordDetail.find(".bot-info").show();$showRecordDetail.find(".status-text").text("预约已确认").addClass("appt_right").removeClass("appt_false").removeClass("appt_warn")}else{if(h==1){$showRecordDetail.find(".bot-info").hide();$showRecordDetail.find(".status-text").text("已就诊").addClass("appt_right").removeClass("appt_false").removeClass("appt_warn")}else{$showRecordDetail.find(".status-text").text("预约待确认").addClass("appt_warn").removeClass("appt_right").removeClass("appt_false");$showRecordDetail.find(".bot-info").show()}}}else{if(j==2||j==3||j==4||j==5){$showRecordDetail.find(".bot-info").hide();$showRecordDetail.find(".status-text").text("已就诊").addClass("appt_right").removeClass("appt_false").removeClass("appt_warn")}else{if(j==8){$showRecordDetail.find(".status-text").text("预约已过期").addClass("appt_warn").removeClass("appt_right").removeClass("appt_false");$showRecordDetail.find(".bot-info").hide()}else{if(j==9){$showRecordDetail.find(".status-text").text("已爽约").addClass("appt_false").removeClass("appt_warn").removeClass("appt_right");$showRecordDetail.find(".bot-info").hide()}}}}}if(k){$showRecordDetail.find(".bot-info").hide()}var d=e.lastOperateLog;if(d&&(d.afterOptApptStatus=="8"||d.afterOptApptStatus=="9")){$showRecordDetail.find(".operator-name").text("系统")}else{if(d&&d.operateUserName&&d.operateUserName!=null&&d.optSource=="pc"){$showRecordDetail.find(".operator-name").text(e.lastOperateLog.operateUserName)}else{$showRecordDetail.find(".operator-name").text("万家会员端")}}$showRecordDetail.find("#patientName").text(Utils.trimObj(e.PATIENT_NAME));$showRecordDetail.find("#patient_no").text(Utils.trimObj(e.PATIENT_NO));if(e.PATIENT_GENDER=="1"){$showRecordDetail.find("#patient_gender").text("男")}else{if(e.PATIENT_GENDER=="2"){$showRecordDetail.find("#patient_gender").text("女")}else{$showRecordDetail.find("#patient_gender").text("保密")}}if(e.APPT_TYPE==1){$showRecordDetail.find("#appt_type_input").text("初诊")}else{if(e.APPT_TYPE==2){$showRecordDetail.find("#appt_type_input").text("复诊")}}$showRecordDetail.find("#mobile_phone_number").text(e.MOBILE_PHONE_NUMBER);$showRecordDetail.find("#appt_date").text(Utils.trimObj(e.APPT_DATE));$showRecordDetail.find("#startAndEndTime").text(Utils.trimObj(e.START_TIME)+"-"+Utils.trimObj(e.END_TIME));$showRecordDetail.find("#apptCreateTime").text(e.ADD_DATE).attr("title",e.ADD_DATE);if(e.DEPARTMENT_NAME){$showRecordDetail.find("#DEPARTMENT_NAME").text(e.DEPARTMENT_NAME)}else{$showRecordDetail.find("#DEPARTMENT_NAME").text("")}if(e.DOCTOR_NAME){$showRecordDetail.find("#DOCTOR_NAME").text(e.DOCTOR_NAME)}else{$showRecordDetail.find("#DOCTOR_NAME").text("")}if(e.APPT_ITEM){$showRecordDetail.find("#APPT_ITEM").text(e.APPT_ITEM)}else{$showRecordDetail.find("#APPT_ITEM").text("")}if(e.APPT_REMARK){$showRecordDetail.find("#APPT_REMARK").text(e.APPT_REMARK)}else{$showRecordDetail.find("#APPT_REMARK").text("")}if(e.PATIENT_BIRTH_DATE){var g=Utils.trimObj(e.PATIENT_BIRTH_DATE);var f=Utils.calcPatientAge(g);if(f!=""){var c=f.split(",");g+="   "+c[0]+"岁"}$showRecordDetail.find("#PATIENT_BIRTH_DATE").text(g)}else{$showRecordDetail.find("#PATIENT_BIRTH_DATE").text("")}if(e.APPT_FLAG==1){$showRecordDetail.find(".healthy-box").show();$showRecordDetail.find("#APPT_ORDER_CODE").text(e.APPT_ORDER_CODE).attr("title",e.APPT_ORDER_CODE);$showRecordDetail.find("#REAL_HEALTHPRODUCT_NAME").text(Utils.trimObj(e.REAL_HEALTHPRODUCT_NAME)).attr("title",Utils.trimObj(e.REAL_HEALTHPRODUCT_NAME));$showRecordDetail.find("#HEALTH_PRODUCT_NAME").text(Utils.trimObj(e.HEALTH_PRODUCT_NAME)).attr("title",Utils.trimObj(e.HEALTH_PRODUCT_NAME));$showRecordDetail.find("#VISIT_INSURANCE_COMPANY").text(Utils.trimObj(e.VISIT_INSURANCE_COMPANY)).attr("title",Utils.trimObj(e.VISIT_INSURANCE_COMPANY));$showRecordDetail.find("#VISIT_INSURANCE_ORDER_NUMBER").text(Utils.trimObj(e.VISIT_INSURANCE_ORDER_NUMBER)).attr("title",Utils.trimObj(e.VISIT_INSURANCE_ORDER_NUMBER));if(e.VISIT_PEOPLE_TYPE==0){$showRecordDetail.find("#visitPeopleType").text("成人")}else{if(e.VISIT_PEOPLE_TYPE==1){$showRecordDetail.find("#visitPeopleType").text("儿童")}}if(e.VISIT_ID_CARD_TYPE_CODE){var a=Utils.trimObj(reserveDetailParams.cardType[e.VISIT_ID_CARD_TYPE_CODE]);if(!a){a=reserveDetailParams.cardType["99"]}$showRecordDetail.find("#VISIT_ID_CARD_TYPE_CODE").text(a)}if(e.VISIT_ID_CARD_NO){$showRecordDetail.find("#VISIT_ID_CARD_NO").text(Utils.trimObj(e.VISIT_ID_CARD_NO)).attr("title",Utils.trimObj(e.VISIT_ID_CARD_NO))}else{$showRecordDetail.find("#VISIT_ID_CARD_NO").text("")}$showRecordDetail.find("#serve-items").text(Utils.trimObj(e.HEALTH_PRODUCT_ITEM_NAME));$showRecordDetail.find("#product-order-code").text(Utils.trimObj(e.PRODUCT_ORDER_CODE))}else{$showRecordDetail.find(".healthy-box").hide()}}var reserveDetailParams={cardType:{"01":"居民身份证","02":"居民户口簿","03":"护照","04":"军官证","05":"驾驶证","06":"港澳居民通行证","07":"台湾居民通行证","98":"深圳市居民健康卡","99":"其他法定有效证件"}};