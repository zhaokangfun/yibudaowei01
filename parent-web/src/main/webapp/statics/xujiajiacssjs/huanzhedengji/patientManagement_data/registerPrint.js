function RegisterPrint(){this.textColor="#4B5263";this.lineColor="#D7D7D7"}var isOpenFlag=false;var isRegisterStyle="1";RegisterPrint.prototype={doPrint:function(d,a,b){var e=this;b=b;a=a;LODOP=getLodop();if(!LODOP){return}LODOP.PRINT_INITA("0mm","0mm","60.7mm","250mm","");LODOP.SET_PRINT_PAGESIZE(3,800,200,"");LODOP.SET_PRINT_MODE("TRYLINKPRINTER_NOALERT",true);if(a==2){LODOP.ADD_PRINT_TEXT("7.49mm","2.5mm","59mm","5.82mm",d.CLINIC_NAME);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"Alignment",2);LODOP.ADD_PRINT_TEXT("17mm","2.53mm","59mm","7.94mm","挂号单");LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",13);LODOP.SET_PRINT_STYLEA(0,"Alignment",2);LODOP.ADD_PRINT_LINE("24.65mm","5.21mm","24.65mm","65.5mm",0,2);LODOP.ADD_PRINT_TEXT("28.93mm","7mm","30.77mm","5.29mm"," 科室："+Utils.trimObj(d.DEPARTMENT_NAME));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",8);LODOP.ADD_PRINT_TEXT("28.93mm","38.01mm","57.41mm","5.29mm","医生："+d.DOCTOR_NAME);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",8);LODOP.ADD_PRINT_TEXT("36.32mm","7mm","28mm","6.01mm"," 诊金："+fixByRound(d.REG_PRICE_SRC,2)+"元");LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",8);LODOP.ADD_PRINT_TEXT("36.32mm","38.01mm","28.49mm","6.01mm","实收："+fixByRound(d.REG_PRICE,2)+"元");LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",8);LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.ADD_PRINT_TEXT("43.72mm","7mm","58mm","6.01mm"," 挂号时间："+Utils.timeStampToDateStr(d.ADD_DATE,10));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",8);LODOP.ADD_PRINT_LINE("48.11mm","5.21mm","48.11mm","65.5mm",0,1);LODOP.ADD_PRINT_TEXT("51.98mm","7mm","47.24mm","6.01mm"," 病历号："+d.PATIENT_NO);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",8);LODOP.ADD_PRINT_TEXT("58.98mm","7mm","55.24mm","6.01mm"," 姓名："+d.PATIENT_NAME);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",8);LODOP.ADD_PRINT_TEXT("58.98mm","38.01mm","51.24mm","6.01mm"," 性别："+getGenderName(d.PATIENT_GENDER));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",8);LODOP.ADD_PRINT_TEXT("65.98mm","7mm","58.24mm","6.01mm"," 年龄："+(d.PATIENT_BIRTH_DATE==null?"":(getAgeByBirthDay(d.PATIENT_BIRTH_DATE)+"岁")));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",8);LODOP.ADD_PRINT_TEXT("65.98mm","38.01mm","58.24mm","6.01mm"," 类型："+e.getTreatmentType(d.TREATMENT_TYPE));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",8);LODOP.ADD_PRINT_TEXT("72.98mm","7mm","65.24mm","6.01mm"," 手机："+(d.MOBILE_PHONE_NUMBER==null?"":d.MOBILE_PHONE_NUMBER));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",8);LODOP.ADD_PRINT_TEXT("72.98mm","38.01mm","65.24mm","6.01mm"," 排队号："+d.QUEUE_NO);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",8);LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.ADD_PRINT_LINE("77.72mm","5.21mm","77.72mm","65.5mm",0,1);LODOP.ADD_PRINT_TEXT("81.18mm","10.06mm","47.63mm","6.61mm"," 注：挂号当日有效，过期作废！");LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",8);if(b==1){LODOP.ADD_PRINT_LINE(350,0,350,320,2,0);LODOP.SET_PRINT_STYLEA(0,"FontColor","#3D3D3D")}}var c=400;if(b=="1"){if(a=="1"){c=20}LODOP.ADD_PRINT_LINE(c+75,"5.21mm",c+75,"65.5mm",0,2);LODOP.ADD_PRINT_LINE(c+235,"5.21mm",c+235,"65.5mm",0,1);LODOP.ADD_PRINT_TEXT(c-15,10,220,25,d.CLINIC_NAME);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",10);LODOP.SET_PRINT_STYLEA(0,"Alignment",2);LODOP.ADD_PRINT_TEXT(c+20,92,67,25,"排号单");LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",13);LODOP.ADD_PRINT_TEXT(c+55,77,57,25,"排队号：");LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",9);LODOP.ADD_PRINT_TEXT(c+51,127,100,25,d.QUEUE_NO);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",13);LODOP.SET_PRINT_STYLEA(0,"Bold",1);LODOP.ADD_PRINT_TEXT(c+90,25,120,25,"姓名："+d.PATIENT_NAME);LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",9);LODOP.ADD_PRINT_TEXT(c+90,136,95,25,"性别："+getGenderName(d.PATIENT_GENDER));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",9);LODOP.ADD_PRINT_TEXT(c+125,25,220,25,"登记时间："+Utils.timeStampToDateStr(d.ADD_DATE,10));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",9);LODOP.ADD_PRINT_TEXT(c+160,25,220,25,"就诊医生："+(d.DOCTORNAME||""));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",9);LODOP.ADD_PRINT_TEXT(c+195,25,220,25,"就诊诊室："+(d.VISIT_ROOM||""));LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",9);LODOP.ADD_PRINT_TEXT(c+250,25,200,25,"*听到叫号请到对应医生诊室进行就诊，感谢您的耐心等待");LODOP.SET_PRINT_STYLEA(0,"FontName","微软雅黑");LODOP.SET_PRINT_STYLEA(0,"FontSize",9)}operateType()},getTreatmentType:function(a){var b="";switch(a){case 1:b="初诊";break;case 2:b="复诊";break;default:break}return b}};var registerPrint=new RegisterPrint();